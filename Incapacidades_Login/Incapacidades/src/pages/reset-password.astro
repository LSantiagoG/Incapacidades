---
import "../styles/styles.css";
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Restablecer contraseña | I-Reports</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet"/>
    <link rel="icon" href="/icono.png" type="image/png" />
  </head>
  <body>
    <ul class="bg-bubbles">
      <li></li><li></li><li></li><li></li><li></li>
      <li></li><li></li><li></li><li></li><li></li>
    </ul>

    <div class="container">
      <div class="form-wrapper">
        <img src="/logos/incapacidades.jpg" alt="Logo" class="logo" />

        <div class="text-center">
          <h3 class="mb-0">Restablecer Contraseña</h3>
          <p class="text-muted mt-2">Ingresa tu nueva contraseña para acceder a tu cuenta</p>
        </div>

        <form id="reset-form">
          <div class="form-group">
            <label for="nuevaClave">Nueva contraseña</label>
            <div class="input-icon-wrapper">
              <i class="mdi mdi-lock field-icon"></i>
              <input type="password" id="nuevaClave" placeholder="••••••••" required minlength="8" />
              <i class="mdi mdi-eye toggle-password" data-target="nuevaClave"></i>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmarClave">Confirmar contraseña</label>
            <div class="input-icon-wrapper">
              <i class="mdi mdi-lock-check field-icon"></i>
              <input type="password" id="confirmarClave" placeholder="••••••••" required />
              <i class="mdi mdi-eye toggle-password" data-target="confirmarClave"></i>
            </div>
          </div>

          <p id="mensaje-error" style="color:red; font-size: 0.9rem; display:none;"></p>

          <button type="submit" class="btn">Actualizar contraseña</button>
          <div class="mt-3 text-center">
            <a href="/" class="text-muted">Volver al inicio de sesión</a>
          </div>
        </form>

        <footer>© 2018 – 2025 Incapacidades.app, Hecho con ❤️</footer>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('reset-form');
        const nuevaClave = document.getElementById('nuevaClave');
        const confirmarClave = document.getElementById('confirmarClave');
        const mensajeError = document.getElementById('mensaje-error');

        form.addEventListener('submit', (e) => {
          e.preventDefault();

          const clave = nuevaClave.value;
          const confirmar = confirmarClave.value;

          if (clave.length < 8) {
            mensajeError.textContent = "La contraseña debe tener al menos 8 caracteres.";
            mensajeError.style.display = "block";
            return;
          }

          if (clave !== confirmar) {
            mensajeError.textContent = "Las contraseñas no coinciden.";
            mensajeError.style.display = "block";
            return;
          }

          mensajeError.style.display = "none";

          // Aquí puedes enviar la contraseña al backend
          alert("Contraseña actualizada correctamente");
          // form.submit(); // Descomenta si estás manejando el submit normalmente
        });

        // Mostrar/ocultar contraseña
        document.querySelectorAll('.toggle-password').forEach(icon => {
          icon.addEventListener('click', () => {
            const target = document.getElementById(icon.dataset.target);
            target.type = target.type === 'password' ? 'text' : 'password';
            icon.classList.toggle('mdi-eye');
            icon.classList.toggle('mdi-eye-off');
          });
        });
      });
    </script>
  </body>
</html>
